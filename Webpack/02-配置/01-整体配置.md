# 整体配置

[整体配置-思维导图](./mind/01-整体配置.html)

## 配置结构

```js
const path = require('path');
module.exports = {
    // 入口（详见entry文档）
    entry: {},
    // 输出结果方式（详见output文档）
    output: {},
    // 配置模块相关（详见module文档）
    module: {},
    // 配置寻找模块的规则（详见resolve文档）
    resolve: {},
    // 开发服务器配置（详见devServer文档）
    devServer: {},
    // 文件监听（详见优化/开发体验文档）
    watch: true,
    watchOptions: {},

    plugins: [],
    performance: {},
    externals: {},
    stats: {},
    context: __dirname,
    devtool: 'source-map',
    target: 'web',

    // 是否启用缓存来提升构建速度
    cache: false,
    // 是否捕捉webpack构建的性能信息，用于分析是什么原因导致构建性能不佳
    profile: true,

}
```

## plugins：用于扩展webpack功能，配置因插件而异

## performance：webpack性能检查配置

```js
module.exports = {
    performance: {
        hints: 'warning', // 有性能问题时输出警告
        hints: 'error', // 有性能问题时输出错误
        hints: false, // 关闭性能检查
        maxAssetSize: 200000, // 最大文件的大小（单位为bytes）
        maxEntrypointSize: 400000, // 最大入口文件的大小(单位为bytes)
        assetFilter: function(assetFilename) { // 过滤要检查的文件
            return assetFilename.endsWith('.css') || assetFilename.endsWith('.js')
        }
    },
}
```

## externals：告诉webpack运行环境已经内置了那些全局变量，无需打包

```js
module.exports = {
    externals: {
        jquery: 'jQuery',
    },
}
```

## stats：控制台输出日志控制

```js
module.exports = {
    stats: {
        assets: true,
        colors: true,
        errors: true,
        errorDetails: true,
        hash: true,
    },
}
```

## context：相对路径的根目录设置

```js
module.exports = {
    context: path.resolve(__dirname， 'app')
}
```

1. 默认值为执行webpack的工作目录
2. 必须为一个绝对路径的字符串
3. 可以在启动webpack时带上参数--context

## devtool：实现业务代码和调试代码的映射

1. 通过sourceMap可以定位到源代码
2. 用于解决开发代码与实际运行代码不一致时调试使用

```js
module.exports = {
    // 关闭
    devtool: 'none'
    // 开发环境配置
    devtool: "cheap-module-eval-source-map",
    //线上不不推荐开启
    // 线上生生成配置
    devtool: "cheap-module-source-map",
};
```

## target：配置输出代码的运行环境

```js
module.exports = {
    target: 'web', // 浏览器，默认
    target: 'webworker', // webworker
    target: 'node', // Node.js ,使用require语句加载chunk代码
    target: 'async-node', // Node.js ，异步加载chunk代码
    target: 'node-webkit', // nw.js
    target: 'electron-main', // electron, 主线程
    target: 'electron-renderer', // electron,渲染线程
}
```
