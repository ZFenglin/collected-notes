<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.7"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, data) => {
        const {
          Markmap
        } = getMarkmap();
        window.mm = Markmap.create('svg#mindmap', getOptions == null ? void 0 : getOptions(), data);
      })(() => window.markmap,null,{"t":"heading","d":1,"p":{"lines":[0,1]},"v":"构建速度","c":[{"t":"heading","d":2,"p":{"lines":[2,3]},"v":"缩小文件搜索范围","c":[{"t":"heading","d":3,"p":{"lines":[6,7]},"v":"Loader配置","c":[{"t":"fence","d":4,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">module</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">rules</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 通过test、include和exclude配置Loader应用规则的文件，提高命中率</span>\n            <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">.jsx?$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">include</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                path<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">exclude</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                path<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'app/demo-files'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":3,"p":{"lines":[26,27]},"v":"resolve配置","c":[{"t":"heading","d":4,"p":{"lines":[28,29]},"v":"resolve.modules","c":[{"t":"fence","d":5,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 利用绝对路径指明第三方模块存储位置，减少逐级向上查找</span>\n        <span class=\"token literal-property property\">modules</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span>dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":4,"p":{"lines":[39,40]},"v":"resolve.mainFields","c":[{"t":"fence","d":5,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 限制模块采用的文件，减少搜索步骤</span>\n        <span class=\"token literal-property property\">mainFields</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":4,"p":{"lines":[50,51]},"v":"resolve.alias（一般不采用）","c":[{"t":"fence","d":5,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">alias</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 利用别名，在导入模块时直接采用模块提供的编译过的文件</span>\n            <span class=\"token literal-property property\">react</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span>\n                __dirname<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"./node_modules/react/umd/react.production.min.js\"</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":4,"p":{"lines":[68,69]},"v":"resolve.extensions","c":[{"t":"fence","d":5,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 1. 后缀列表尽可能短</span>\n        <span class=\"token comment\">// 2. 频率高的放前面</span>\n        <span class=\"token comment\">// 3. 引入代码时尽可能带上后缀</span>\n        <span class=\"token literal-property property\">extensions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.css'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.json'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.jsx'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]}]},{"t":"heading","d":3,"p":{"lines":[81,82]},"v":"noParse忽略文件","c":[{"t":"fence","d":4,"v":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 配置模块相关</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">module</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 使用noParse忽略部分没有采用模块化的文件的递归解析和处理</span>\n        <span class=\"token literal-property property\">noParse</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">react\\.min\\.js$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]}]},{"t":"heading","d":2,"p":{"lines":[93,94]},"v":"DllPlugin（推荐HardSourceWebpackPlugin替代）","c":[{"t":"heading","d":3,"p":{"lines":[99,100]},"v":"DllPlugin提速原理","c":[{"t":"list_item","d":5,"p":{"lines":[101,102],"index":1},"v":"1. 将网页依赖的模块抽离出来并打包到一个个单独的动态链接库中"},{"t":"list_item","d":5,"p":{"lines":[102,103],"index":2},"v":"2. 下次导入的模块存在于某个动态链接库中，则模块会从动态库中获取"},{"t":"list_item","d":5,"p":{"lines":[103,104],"index":3},"v":"3. 页面需要的所有动态链接库都需要被加载"}]},{"t":"heading","d":3,"p":{"lines":[105,106]},"v":"DllPlugin优化实现","c":[{"t":"ordered_list","d":4,"p":{"lines":[107,110],"start":1},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[107,108],"index":1},"v":"1. DllPlugin（打包）: 用于打包出一个个单独的动态链接库文件"},{"t":"list_item","d":5,"p":{"lines":[108,109],"index":2},"v":"2. DllReferencePlugin（链接）: 用于在主要的配置文件中引入DllPlugin插件打包好的动态链接库文件"}]},{"t":"heading","d":4,"p":{"lines":[110,111]},"v":"打包dll","c":[{"t":"ordered_list","d":5,"p":{"lines":[112,116],"start":1},"v":"","c":[{"t":"list_item","d":6,"p":{"lines":[112,113],"index":1},"v":"1. 创建webpack.dll.config.js文件，并设置好DllPlugin对应配置"},{"t":"list_item","d":6,"p":{"lines":[113,114],"index":2},"v":"2. package.json中添加&quot;dev:dll&quot;: &quot;webpack --config ./build/webpack.dll.config.js&quot;指令，并运行命令npm run dev:dll"},{"t":"list_item","d":6,"p":{"lines":[114,115],"index":3},"v":"3. 此时多一个dll文件夹，同时里面有单独打包的React文件，之后发开发阶段将不会再对React进行编译，节约开发时间"}]},{"t":"heading","d":5,"p":{"lines":[116,117]},"v":"dll文件结构","c":[{"t":"list_item","d":7,"p":{"lines":[118,119],"index":1},"v":"1. dll文件包含大量模块的代码，并将模块放置数组中，用索引做id，暴露在全局中，使用window.xxx访问"},{"t":"list_item","d":7,"p":{"lines":[119,120],"index":2},"v":"2. Manifest.json 描述了dll.js包含那些模块，以及id和路径"}]}]},{"t":"heading","d":4,"p":{"lines":[121,122]},"v":"链接dll","c":[{"t":"list_item","d":6,"p":{"lines":[123,124],"index":1},"v":"1. webpack.dev.config.js文件中引入插件DllReferencePlugin，并设置好配置"},{"t":"list_item","d":6,"p":{"lines":[124,125],"index":2},"v":"2. HTML引入打包好的dll文件（add-asset-html-webpack-plugin插件可以直接设置引入）"}]}]}]},{"t":"heading","d":2,"p":{"lines":[128,129]},"v":"构建缓存","c":[{"t":"fence","d":3,"v":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token maybe-class-name\">HardSourceWebpackPlugin</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hard-source-webpack-plugin'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> plugins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">HardSourceWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span>\n</code></pre>\n"}]},{"t":"heading","d":2,"p":{"lines":[141,142]},"v":"多进程构建处理","c":[{"t":"heading","d":3,"p":{"lines":[145,146]},"v":"任务多进程","c":[{"t":"list_item","d":5,"p":{"lines":[147,148],"index":1},"v":"1. HappyPack"},{"t":"list_item","d":5,"p":{"lines":[148,149],"index":2},"v":"2. thread-loader（推荐，配置起来更简单）"}]},{"t":"heading","d":3,"p":{"lines":[150,151]},"v":"代码压缩多进程","c":[{"t":"list_item","d":5,"p":{"lines":[152,153],"index":1},"v":"1. webpack内置UglifyJS但是不支持多进程，ParallelUglifyPlugin可以代码压缩多进程处理"},{"t":"list_item","d":5,"p":{"lines":[153,154],"index":2},"v":"2. 小项目不推荐，进程会产生开销反而降速"}]}]},{"t":"heading","d":2,"p":{"lines":[155,156]},"v":"IgnorePlugin","c":[{"t":"fence","d":3,"v":"<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>IgnorePlugin</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^\\.\\/locale$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">moment$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":2,"p":{"lines":[165,166]},"v":"减少编译代码","c":[{"t":"list_item","d":4,"p":{"lines":[169,170],"index":1},"v":"1. 外部扩展externals，配置对应引入，将文件放入CDN减少编译代码"},{"t":"list_item","d":4,"p":{"lines":[170,171],"index":2},"v":"2. Tree-shaking与Scope Hoisting"}]}]})</script>
</body>
</html>
