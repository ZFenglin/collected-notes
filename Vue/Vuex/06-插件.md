# VUEX插件

vuex的插件就是一个返回function的function，同时返回的function存在参数store

1. store支持获取stroe的方法
2. store同时支持注册回调  store.subscribe((mutation, state) => {})

```js
// logger插件
function logger() {
    return function(store) {
        let prevState = JSON.stringify(store.state)
        store.subscribe((mutation, state) => {
            // 所有更新操作都基于mutation,状态变化通过mutation
            // 如果直接受到的更改状态，此subscribe是不会执行的(只有mutation的会触发通知)
            console.log('prevState', prevState)
            console.log('mutation', mutation)
            console.log('currentState', JSON.stringify(state))
            prevState = JSON.stringify(state)
        })
    }
}

// vuex持久化插件
function persists() {
    // 每次状态变化存至localstorge
    return function(store) {
        let localState = JSON.parse(localStorage.getItem('VUEX:STATE'))
        if (localState) {
            store.replaceState(localState)
        }
        store.subscribe((mutations, rooState) => {
            localStorage.setItem('VUEX:STATE', JSON.stringify(rooState))
        })
    }
}

const store = new Vuex.Store({
    // 插件使用
    plugins: [
        logger(),
        persists()
    ],
})
```
