<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.7"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, data) => {
        const {
          Markmap
        } = getMarkmap();
        window.mm = Markmap.create('svg#mindmap', getOptions == null ? void 0 : getOptions(), data);
      })(() => window.markmap,null,{"t":"heading","d":1,"p":{"lines":[0,1]},"v":"<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket\">WebSocket</a>","c":[{"t":"ordered_list","d":2,"p":{"lines":[1,5],"start":1},"v":"","c":[{"t":"list_item","d":3,"p":{"lines":[1,2],"index":1},"v":"1. WebSocket是 HTML5 定义的一个新的网络传输协议"},{"t":"list_item","d":3,"p":{"lines":[2,3],"index":2},"v":"2. 可在单个TCP连接上进行全双工通信"},{"t":"list_item","d":3,"p":{"lines":[3,4],"index":3},"v":"3. 位于OSI模型的应用层"}]},{"t":"heading","d":2,"p":{"lines":[5,6]},"v":"使用","c":[{"t":"fence","d":3,"v":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 创建连接实例</span>\n<span class=\"token keyword\">const</span> socket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebSocket</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ws://localhost:8080'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 连接监听</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'open'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    socket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello Server!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 关闭监听</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'close'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    socket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bey Server!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 服务端消息监听</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Message from server '</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 发送消息</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello WebSockets!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"t":"heading","d":2,"p":{"lines":[30,31]},"v":"即时通讯","c":[{"t":"heading","d":3,"p":{"lines":[32,33]},"v":"短轮询","c":[{"t":"list_item","d":5,"p":{"lines":[34,35],"index":1},"v":"1. 浏览器每隔一段时间向浏览器发送 http 请求"},{"t":"list_item","d":5,"p":{"lines":[35,36],"index":2},"v":"2. 服务器端在收到请求后，不论是否有数据更新，都直接进行响应"}]},{"t":"heading","d":3,"p":{"lines":[37,38]},"v":"长轮询","c":[{"t":"list_item","d":5,"p":{"lines":[39,40],"index":1},"v":"1. 首先由客户端向服务器发起请求"},{"t":"list_item","d":5,"p":{"lines":[40,41],"index":2},"v":"2. 当服务器收到客户端发来的请求后，服务器端不会直接进行响应，先将这个请求挂起"},{"t":"list_item","d":5,"p":{"lines":[41,42],"index":3},"v":"3. 判断服务器端数据是否有更新"},{"t":"list_item","d":5,"p":{"lines":[42,43],"index":4},"v":"4. 如果有更新，则进行响应，如果一直没有数据，则到达一定的时间限制才返回"}]},{"t":"heading","d":3,"p":{"lines":[44,45]},"v":"<a href=\"https://juejin.cn/post/6854573215516196878\">SSE</a>","c":[{"t":"list_item","d":5,"p":{"lines":[46,47],"index":1},"v":"1. 服务器使用流信息向服务器推送信息"}]},{"t":"heading","d":3,"p":{"lines":[48,49]},"v":"WebSocket","c":[{"t":"list_item","d":5,"p":{"lines":[50,51],"index":1},"v":"1. 该协议允许由服务器主动的向客户端推送信息"}]},{"t":"heading","d":3,"p":{"lines":[52,53]},"v":"比较","c":[{"t":"list_item","d":5,"p":{"lines":[54,55],"index":1},"v":"1. 前三个都是基于HTTP协议的"},{"t":"list_item","d":5,"p":{"lines":[55,56],"index":2},"v":"2. 性能：WebSocket &gt; 服务端消息推送（SSE） &gt; 长轮询 &gt; 短轮询"},{"t":"list_item","d":5,"p":{"lines":[56,57],"index":3},"v":"3. 兼容性： 短轮询 &gt; 长轮询 &gt; 服务端消息推送（SSE） &gt; WebSocket"}]}]}]})</script>
</body>
</html>
