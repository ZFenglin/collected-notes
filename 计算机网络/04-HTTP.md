 # HTTP 
 
超文本传输协议（Hyper Text Transfer Protocol，HTTP）
一个简单的请求-响应协议，它通常运行在TCP之上

## HTTP优缺点

### HTTP优点

1. 请求和响应方式简单
2. 支持任何资源

### HTTP缺点

1. 不安全
   1. 明文传输
   2. 无法验证身份
   3. 消息完整性无法确定

## 版本比较

### HTTP1.0

1. 短连接
   1. 一个请求一个连接，完成后断开
2. 可以传输任何资源
3. 信息头
4. 状态码
5. GET/POST/HEAD
6. 缓存
   1. Expires

### HTTP1.1

1. 持久连接
   1. 默认Connection: keep-alive，同时具有管道机制

    >管道机制： 同一个TCP连接可以发送多个HTTP请求，但是同一时刻只能处理一个请求，队首处理时间过长，会导致其他请求一直等待，造成队头堵塞

2. 字节范围请求（range）
   1. range头来请求部分资源，返回206
3. 默认发送HOST头
4. PUT/PATCH/HEAD/OPTIONS/DELETE
5. 缓存
   1. 协商缓存
      1. Etag、If-None-Match
      2. Last-Modified、If-Modified-Since
   2. 强缓存
      1. 增加Cache-Control

### HTTP2

1. 流传输（二进制帧）
   1. 二进制传输，将消息分成多帧进行传输
2. 多路复用
   1. 一个域名只用一个TCP长连接进行数据传输
   2. 不需要按照顺序发送，处理了队头堵塞
3. 头部压缩
   1. 头信息经过gzip或compress压缩后再发送
   2. [HPACK算法](https://segmentfault.com/a/1190000017011816)：客户端和服务器维护一张头信息表，后续双方通信发送差异头部

        

![HPACK算法](./assets/04-HPACK算法.png)

4. 服务器推送SSE
   1. 服务器可以在未请求的情况下向客户端发送数据

#### 页面请求多张图片

HTTP1：由于TCP最大连接数是6，只能同时6张加载，并且后续的依次加载

HTTP2：多路复用的支持，请求无限制，可以同时传输

### HTTP3

基于UDP的QUIC协议实现
存在以下几个优势
1. 原生支持多路复用
   1. 同一物理连接上可以有多个独立的逻辑数据流
2. 加密认证的报文
   1. 头部经过认证
   2.  内容经过加密
3. 基于UDP从而支持快速握手

![HTTP3](./assets/04-HTTP3.png)

## 请求方式

### GET

获取服务器数据

### POST

提交实体到指定资源

#### 与GET的差异

1. 影响服务器资源
   1. GET一般不会影响资源
   2. POST一般用于新增或修改资源
2. 缓存
   1. GET一般默认缓存
   2. POST一般不缓存
3. 参数
   1. GET将参数放在URL中，参数长度受限，不安全并且会留存在历史记录中

        > GET长度限制
        >1. 主流浏览器IE的URL最短的，限制是2083字节
        >2. GET的长度值 = URL（2083）- （你的Domain+Path）-2（2是get请求中?=两个字符的长度）

   2. POST将数据放在报文中，长度不限

### PUT

更新，上传文件

### DELETE

删除服务器对象

### HEAD

获取报文首部，与GET相比，不返回报文主体部分

### OPTIONS

获取目的资源所支持的通信选项

#### OPTIONS请求作用

CORS 中的预检请求，检测服务器所支持的HTTP请求方法和请求头

### TRACE

回显服务器收到的请求，主要⽤于测试或诊断
