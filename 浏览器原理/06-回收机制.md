# [回收机制](https://juejin.cn/post/6981588276356317214)

## 垃圾回收机制

Garbage Collection（GC），在引擎内部工作负责垃圾回收的机制

### 垃圾对象

内存管理是自动的

不再被引用并且不能从根上访问到的对象就是垃圾对象

#### 垃圾对象产生

对象的引用更换或者设置null

默认的存在堆内存中的数据就是需要回收的无效垃圾

## 内存分析

### 内存问题

1. 内存泄露：内存使用持续升高
2. 内存膨胀：多数设备存在性能问题
3. 频繁垃圾回收：内存变化图查看

#### 造成的问题

1. 页面出现延迟加载和经常性暂停
2. 页面持续性出现糟糕的性能
3. 时间越长越来越差

### 检查内存方式

#### 浏览器任务管理器

浏览器任务管理器会显示内存和JavaScript内存

##### 内存

1. 原生内存
2. DOM节点占据内存

##### JavaScript内存

对象占据内存

#### TimeLine时序图记录

使用Performance工具

1. 浏览器打开目标网址
2. 进入开发人员工具面板，选择性能
3. 点击录制，访问具体页面
4. 执行用户行为，一段时间后停止录制
5. 分析界面中记录的内存信息

#### 堆快照查找分离DOM

开发者工具内存部分的堆快照，检查快照是否存在DOM未使用

##### 分离DOM

1. 界面元素存活在DOM树上
2. 垃圾对象时的DOM节点
3. 分离状态的DOM节点

#### 判断是否存在频繁垃圾回收

1. TimeLine时序图频繁上升下降
2. 任务管理器频繁增加减少

## 回收优化

### 影响性能原因

#### 内存泄漏

1. 全局变量的使用
2. 定时器未清除
3. 被删除的DOM元素的引用
4. 不合理的使用闭包

#### 回收频繁触发

### 优化方式

#### 无用对象加速回收

设置为null

#### 减少回收触发

1. 用设置长度为0来清空数组
2. 循环函数中可以复用部分迁移到函数外部
