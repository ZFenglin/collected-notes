# 闭包

1. 闭包是基于词法作用域书写代码时所产生的自然结果
2. 函数可以记住并访问所在的词法作用域时，就产生了闭包
3. 即使函数是在当前作用域之外执行，仍然可以访问闭包内属性

```js
function foo() {
    var a = 2
    return function bar() {
        console.log(a)
    }
}
```

## 闭包特点

1. 函数可以访问另一个函数的作用域下的变量
2. 局部变量会常驻在内存中，可能会造成内存泄漏
3. 可以用于避免使用全局变量，防止污染

## 作用：[详见JavaScript/手写代码/函数相关](../08-代码手写/03-函数相关.md)

### 处理循环问题（let可以处理）

当let和const出现之前，循环体中由于var的提升，i将会不会按照循环触发的方式打印结果，利用闭包解决

```js
for (var i = 1; i <= 5; i++) {
    (function(j) {
        setTimeout(function timer() {
            console.log(j)
        }, j * 1000);
    })(i)
}
```

### 模块化

#### 模块化的使用条件

1. 必须有外部的封闭函数，该函数必须至少被调用一次
2. 封闭函数必须返回至少一个内部函数，这样内部函数才能在私有作用域中形成闭包

### 柯里化

1. 柯里化可以让函数存在多个参数时可以先传递一部分参数调用它，并返回一个新函数接收剩余参数并执行，直到接收完所有参数后返回结
2. lodash的_.curry(func)就是一个柯里化工具函数

#### 柯里化特点

1. 函数参数的缓存
2. 函数更灵活，细粒度更小
3. 多元函数变成一元函数

### 防抖和节流

#### 函数防抖

1. 函数防抖是指在事件被触发 n 秒后再执行回调，如果在这 n 秒内事件又被触发，则重新计时
2. 使用在一些点击请求的事件上，避免因为用户的多次点击向后端发送多次请求

#### 函数节流

1. 函数节流是指规定一个单位时间，在这个单位时间内，只能有一次触发事件的回调函数执行
2. 节流可以使用在 scroll 函数的事件监听上，通过事件节流来降低事件调用的频率
